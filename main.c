#include "gn.h"
#include <string.h>

int main() {
  struct gn p, q, n, r, v, result;
  struct gn null;
  gn_init(&null);

  int k = 65;
  gn_init(&p);
  gn_init(&q);
  gn_init(&n);
  gn_init(&r);
  gn_init(&v);
  gn_init(&result);

  char p_str[] = "000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000283";
  char q_str[] = "000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000439";
  char r_str[] = "0000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000";
  char v_str[] = "00000003bf8255c5567fde783c1bbee89936c74a3821206a76d40badc077c6de5e683e96bee84cd491263472c7c1ba7c63275c70c713fdb0dc23fc4bd235f684c48a42572fe5eafb2202daff387882fe53fdd3ad09997de95e5ad4da99535866de403895892fac01c0e6201ac310eb5bba7f004dffafaaac0fc4741fb5037df0c4e25e156fffd7155595b2db38f7ee7ed0d37ccabab0f34c02d9c45a85670588d2a5d26085af3e794e5204bc51808c3fc84d11bb5bb365d25a7ceab1220ff621287dcd8abf317df176f14ae950b1f816f19656e998baa26e330ebfd64d69cb50221708677e200a9e6de2ba073cb3fba40a8224c9637e486540df1a2b0dbea09361248e15528b47d";
  gn_from_string(&p, p_str, strlen(p_str));
  gn_from_string(&q, q_str, strlen(q_str));
  gn_from_string(&r, r_str, strlen(r_str));
  gn_from_string(&v, v_str, strlen(v_str));
  gn_mul(&p, &q, &n);

  //Start code 
  struct gn a,b;
  gn_init(&a);
  gn_init(&b);

  char a_str[] = "000000002795503eedd56307cd5cede1130ac7806b79e1900a9eaf2e02df896a7dcceba9f29890997bcad2a323d7e1499b3691a01b56a089aafe1d03cc63df0fa91a8957797ebf17db1322cc81d70fee370256a3192f311d7311e76be2a1ea36d208a0416e7a365aefd00cc9d9b9813a6abbdcee4a4727a0e744d65e1c377b825e2b780baf8b70f5470afe79f7f7dbb6397810183f6ea2b8814c54adea6df8232bcfbfa6118e2dae758e79edccb7f85e1dca6e8bc08f0aca6371a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a9b2b";
  char b_str[] = "000000000000615bc9c29a73506932dc09991aa1f39564d4ec3454884765721ac3eef6750e37f12223349b6820f3569dbdd592f23f5e6df99bc58ef51a65ce0c8cf99725ca0a50e900583608de6bc29aefaaf615b432848fbb687fd4230cf2823302c7d02e169c387b8e571ccb1bd46d7ecdf11e27f0a5d6a611018f5a9253a18325ea0a772903de8dbe548cc76cf6e2d695fa0afc6e5860972ed29b40d334cfc5cf4952c5c0ffd1b887b6019b012d1e1289ed87ba8a6d39054916738df600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a9b2b";
  gn_from_string(&a, a_str, strlen(a_str));
  gn_from_string(&b, b_str, strlen(b_str));
  printf("A: ");
  gn_print(&a);
  printf("B: ");
  gn_print(&b);
  printf("N: ");
  gn_print(&n);
  printf("R: ");
  gn_print(&r);
  printf("V: ");
  gn_print(&v);
  printf("AxB: ");
  montgomery_multiplication(&a, &b, &n, &r, &v, k, &result);
  gn_print(&result);

  return 0;
}