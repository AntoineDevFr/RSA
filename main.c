#include "gn.h"
#include <string.h>

int main() {
  struct gn p, q, n, r, v, r2, result;
  struct gn null;
  gn_init(&null);

  int k = 65;
  gn_init(&p);
  gn_init(&q);
  gn_init(&n);
  gn_init(&r);
  gn_init(&v);
  gn_init(&r2);
  gn_init(&result);

  char p_str[] = "000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000283";
  char q_str[] = "000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000439";
  char r_str[] = "0000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000";
  char v_str[] = "00000003bf8255c5567fde783c1bbee89936c74a3821206a76d40badc077c6de5e683e96bee84cd491263472c7c1ba7c63275c70c713fdb0dc23fc4bd235f684c48a42572fe5eafb2202daff387882fe53fdd3ad09997de95e5ad4da99535866de403895892fac01c0e6201ac310eb5bba7f004dffafaaac0fc4741fb5037df0c4e25e156fffd7155595b2db38f7ee7ed0d37ccabab0f34c02d9c45a85670588d2a5d26085af3e794e5204bc51808c3fc84d11bb5bb365d25a7ceab1220ff621287dcd8abf317df176f14ae950b1f816f19656e998baa26e330ebfd64d69cb50221708677e200a9e6de2ba073cb3fba40a8224c9637e486540df1a2b0dbea09361248e15528b47d";
  char r2_str[] = "000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff5d6f676800000000000006bbfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffe8f7ba3488900000000000a9b2b";
  
  gn_from_string(&p, p_str, strlen(p_str));
  gn_from_string(&q, q_str, strlen(q_str));
  gn_from_string(&r, r_str, strlen(r_str));
  gn_from_string(&v, v_str, strlen(v_str));
  gn_from_string(&r2, r2_str, strlen(r2_str));
  gn_mul(&p, &q, &n);

  //Start code 
  struct gn a,b;
  gn_init(&a);
  gn_init(&b);

  char a_str[] = "0000000000e9d71b689dde71afaab8f01e6e10b4a6c8fbefc8e87174fff8db71f5937bc2b1d0b99995681d3c5a7b62b4dde94f518729365b4b257d345c0c9c6d895327d26796eb7fecb616bcc9a553d75b850e45b574a268352514490bd201fa32f83ff804c5baaf0bab08d4dd46ff6fb9ddcec6a1ec20089bf5d93b186d59cf70345baba58e8c0bee6c6d95293dd273c16b124cf8514b5ef3baecc59568aa3cb4e990b5a70445d66913f4f82d75511acae1f40958ed0dadbdee4bd14d2cef77188607082c24aaccfc9a2e80be2fe7812183d37a1e6cc2866c461c05fd0859d7f92908b3d318df18cdbc2a3e3bf70dbe2d0";
  char b_str[] = "0000000000e9d71b689dde71afaab8f01e6e10b4a6c8fbefc8e87174fff8db71f5937bc2b1d0b99995681d3c5a7b62b4dde94f518729365b4b257d345c0c9c6d895327d26796eb7fecb616bcc9a553d75b850e45b574a268352514490bd201fa32f83ff804c5baaf0bab08d4dd46ff6fb9ddcec6a1ec20089bf5d93b186d59cf70345baba58e8c0bee6c6d95293dd273c16b124cf8514b5ef3baecc59568aa3cb4e990b5a70445d66913f4f82d75511acae1f40958ed0dadbdee4bd14d2cef77188607082c24aaccfc9a2e80be2fe7812183d37a1e6cc2866c461c05fd0859d7f92908b3d318df18cdbbda9432a5d3eafcf";
  gn_from_string(&a, a_str, strlen(a_str));
  gn_from_string(&b, b_str, strlen(b_str));
  // printf("a: ");
  // gn_print(&a);
  // printf("b: ");
  // gn_print(&b);
  // printf("n: ");
  // gn_print(&n);
  // printf("r: ");
  // gn_print(&r);
  // printf("v: ");
  // gn_print(&v);
  // montgomery_multiplication(&a, &b, &n, &r, &v, k, &result);
  // gn_print(&result);

  square_and_multiply(&a,&b,&r2,&r,&n,&v,&result);

  printf("result: ");
  gn_print(&result);
  return 0;
}